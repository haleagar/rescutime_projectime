<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rescuetime Data Query for Time Reports</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="node_modules/jsonq/jsonQ.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="addTable.js"></script>
    <script src="projectSetup.js"></script>
    <script src="rescutimeparser.js"></script>


    <script>
        function convertTime (rescutimesamp) {
            var hours   = parseInt(rescutimesamp.substring(12, 14), 10),
                    minutes = parseInt(rescutimesamp.substring(14, 16), 10),
                    ampm    = 'am';

            if (hours == 12) {
                ampm = 'pm';
            } else if (hours == 0) {
                hours = 12;
            } else if (hours > 12) {
                hours -= 12;
                ampm = 'pm';
            }

            return hours + ':' + str_pad_left(minutes,'0',2) + ' ' + ampm;
        }
        function str_pad_left(string,pad,length) {
            return (new Array(length+1).join(pad)+string).slice(-length);
        }
        function min_hour_display (minutes, seconds) {
            minutes = minutes || 0;
            seconds = seconds || 0;
            var time = (minutes*60)+seconds;
            var hours = Math.floor(time / 3600);
            time = time - hours * 3600;
            minutes = Math.round(time / 60);
            //seconds = time - minutes * 60;
            return hours+':'+str_pad_left(minutes,'0',2); // +':'+str_pad_left(seconds,'0',2);
        }
        $( function() {
            console.log( "ready!" );
            $('button#show-totals').click( function( event ) {
                var projtotals = {UNALLOCATED:0};
                $.each( document.proj, function( projname, keywords ) {
                    projtotals[projname] = 0
                });

                $.each( document.strucArray, function( index, row ) {
                    $.each( row.project[0], function( projname, total ) {
                        if (total > 150) { projtotals[projname] +=5}
                        else if(total > 75) {projtotals[projname] +=2.5}
                        else if(total > 30) {projtotals[projname] +=1}
                    });
                });

                $('#totalby5-wahv').val(min_hour_display(projtotals.WAHV));
                $('#totalby5-greenhill').val(min_hour_display(projtotals.GREENHILL));
                $('#totalby5-pch').val(min_hour_display(projtotals.PCH));
                $('#totalby5-pgpf').val(min_hour_display(projtotals.PGPF));
                $('#totalby5-resolution').val(min_hour_display(projtotals.RESOLUTION));
                $('#totalby5-personal').val(min_hour_display(projtotals.PERSONAL));
                $('#totalby5-door3').val(min_hour_display(projtotals.DOOR3));
                $('#totalby5-unallocated').val(min_hour_display(projtotals.UNALLOCATED));

                var modval = Number($('#total-mod').val());
                console.log('modval',modval);
                console.log('projtotals.WAHV',projtotals.WAHV);
                $('#totalmod-wahv').val(min_hour_display(projtotals.WAHV*modval));
                $('#totalmod-greenhill').val(min_hour_display(projtotals.GREENHILL*modval));
                $('#totalmod-pch').val(min_hour_display(projtotals.PCH*modval));
                $('#totalmod-pgpf').val(min_hour_display(projtotals.PGPF*modval));
                $('#totalmod-resolution').val(min_hour_display(projtotals.RESOLUTION*modval));
                $('#totalmod-personal').val(min_hour_display(projtotals.PERSONAL*modval));
                $('#totalmod-door3').val(min_hour_display(projtotals.DOOR3*modval));
                $('#totalmod-unallocated').val(min_hour_display(projtotals.UNALLOCATED*modval));



                var wahvtotal = 0;
                $('td.col-WAHV').each(function() {
                    wahvtotal += Number($(this).html());
                });
                $('#total-wahv').val(min_hour_display(0,wahvtotal));

                var greentotal = 0;
                $('td.col-GREENHILL').each(function() {
                    greentotal += Number($(this).html());
                });
                $('#total-greenhill').val(min_hour_display(0,greentotal));

                var pchtotal = 0;
                $('td.col-PCH').each(function() {
                    pchtotal += Number($(this).html());
                });
                $('#total-pch').val(min_hour_display(0,pchtotal));

                var pgpftotal = 0;
                $('td.col-PGPF').each(function() {
                    pgpftotal += Number($(this).html());
                });
                $('#total-pgpf').val(min_hour_display(0,pgpftotal));

                var restotal = 0;
                $('td.col-RESOLUTION').each(function() {
                    restotal += Number($(this).html());
                });
                $('#total-resolution').val(min_hour_display(0,restotal));

                var persionaltotal = 0;
                $('td.col-PERSONAL').each(function() {
                    persionaltotal += Number($(this).html());
                });
                $('#total-personal').val(min_hour_display(0,persionaltotal));

                var unallocatedtotal = 0;
                $('td.col-UNALOCATED').each(function() {
                    unallocatedtotal += Number($(this).html());
                });
                $('#total-unallocated').val(min_hour_display(0,unallocatedtotal));

                var door3total = 0;
                $('td.col-DOOR3').each(function() {
                    door3total += Number($(this).html());
                });
                $('#total-door3').val(min_hour_display(0,door3total));

                var missingtotal = 0;
                $('td.col-missing').each(function() {
                    missingtotal += Number($(this).html());
                });
                $('#total-missing').val(min_hour_display(0,missingtotal));
            });
            $( ".tabs" ).tabs();
            $( 'input[type="checkbox"]' ).checkboxradio();

            $( "#datepicker" ).datepicker();

            $('a#show-data').click( function( event ) {
                event.preventDefault();
                $('td.col-data').show();
                $('th.col-data').show();
            });
            $('a#hide-data').click( function( event ) {
                event.preventDefault();
                $('td.col-data').hide();
                $('th.col-data').hide();
            });
            $('a#show-projects').click( function( event ) {
                event.preventDefault();
                $('td.col-project').show();
                $('th.col-project').show();
            });
            $('a#hide-projects').click( function( event ) {
                event.preventDefault();
                $('td.col-project').hide();
                $('th.col-project').hide();
            });

            $('button#hide-proj-all').click( function( event ) {
                $("input#checkbox-unalocated")[0].checked = false;
                $("input#checkbox-unalocated").click()
                $("input#checkbox-wahv")[0].checked = false;
                $("input#checkbox-wahv").click()
                $("input#checkbox-greenhill")[0].checked = false;
                $("input#checkbox-greenhill").click()
                $("input#checkbox-pch")[0].checked = false;
                $("input#checkbox-pch").click()
                $("input#checkbox-pgpf")[0].checked = false;
                $("input#checkbox-pgpf").click()
                $("input#checkbox-resolution")[0].checked = false;
                $("input#checkbox-resolution").click()
                $("input#checkbox-personal")[0].checked = false;
                $("input#checkbox-personal").click()
                $("input#checkbox-door3")[0].checked = false;
                $("input#checkbox-door3").click()
            });
            $("input#checkbox-unalocated").change(function() {
                if(this.checked) {
                    $('tr.row-UNALOCATED').hide();
                } else {
                    $('tr.row-UNALOCATED').show();
                }
            });
            $("input#checkbox-wahv").change(function() {
                if(this.checked) {
                    $('tr.row-WAHV').hide();
                } else {
                    $('tr.row-WAHV').show();
                }
            });
            $("input#checkbox-greenhill").change(function() {
                if(this.checked) {
                    $('tr.row-GREENHILL').hide();
                } else {
                    $('tr.row-GREENHILL').show();
                }
            });
            $("input#checkbox-pch").change(function() {
                if(this.checked) {
                    $('tr.row-PCH').hide();
                } else {
                    $('tr.row-PCH').show();
                }
            });
            $("input#checkbox-pgpf").change(function() {
                if(this.checked) {
                    $('tr.row-PGPF').hide();
                } else {
                    $('tr.row-PGPF').show();
                }
            });
            $("input#checkbox-resolution").change(function() {
                if(this.checked) {
                    $('tr.row-RESOLUTION').hide();
                } else {
                    $('tr.row-RESOLUTION').show();
                }
            });

            $("input#checkbox-personal").change(function() {
                if(this.checked) {
                    $('tr.row-PERSONAL').hide();
                } else {
                    $('tr.row-PERSONAL').show();
                }
            });

            $("input#checkbox-door3").change(function() {
                if(this.checked) {
                    $('tr.row-DOOR3').hide();
                } else {
                    $('tr.row-DOOR3').show();
                }
            });


            $( "button#load-data" ).click( function( event ) {
                event.preventDefault();
                getRescutimeData();
            } );

        });

    </script>
</head>
<body>
todo
<ul>
    <li>http://www.jeasyui.com/demo/main/index.php?plugin=DataGrid&theme=default&dir=ltr&pitem=</li>
    <li>count/display overcounts</li>
    <li>display day total</li>
    <li>check all option on hide rows</li>
    <li>structure the project form elemets and functions to avoid manual duplication</li>
    <li>save the project settings</li>
    <li>duplicate project colum title</li>
</ul>

<label>Pick a day to load: </label><div id="datepicker"></div>
<button id="load-data" class="ui-button ui-widget ui-corner-all">load data</button>
<div id="totals-display">
    <button id="show-totals" class="ui-button ui-widget ui-corner-all">show totals</button><br>
    <table>
        <tr><td>wahv</td><td><input type="text" name="total-wahv" id="total-wahv" value=""></td><td><input type="text" name="totalby5-wahv" id="totalby5-wahv" value=""></td><td><input type="text" name="totalmod-wahv" id="totalmod-wahv" value=""></td></tr>
        <tr><td>greenhill</td><td><input type="text" name="total-greenhill" id="total-greenhill" value=""></td><td><input type="text" name="totalby5-greenhill" id="totalby5-greenhill" value=""></td><td><input type="text" name="totalmod-greenhill" id="totalmod-greenhill" value=""></td></tr>
        <tr><td>pch</td><td><input type="text" name="total-pch" id="total-pch" value=""></td><td><input type="text" name="totalby5-pch" id="totalby5-pch" value=""></td><td><input type="text" name="totalmod-pch" id="totalmod-pch" value=""></td></tr>
        <tr><td>pgpf</td><td><input type="text" name="total-pgpf" id="total-pgpf" value=""></td><td><input type="text" name="totalby5-pgpf" id="totalby5-pgpf" value=""></td><td><input type="text" name="totalmod-pgpf" id="totalmod-pgpf" value=""></td></tr>
        <tr><td>resolution</td><td><input type="text" name="total-resolution" id="total-resolution" value=""></td><td><input type="text" name="totalby5-resolution" id="totalby5-resolution" value=""></td><td><input type="text" name="totalmod-resolution" id="totalmod-resolution" value=""></td></tr>
        <tr><td>personal</td><td><input type="text" name="total-personal" id="total-personal" value=""></td><td><input type="text" name="totalby5-personal" id="totalby5-personal" value=""></td><td><input type="text" name="totalmod-personal" id="totalmod-personal" value=""></td></tr>
        <tr><td>door3</td><td><input type="text" name="total-door3" id="total-door3" value=""></td><td><input type="text" name="totalby5-door3" id="totalby5-door3" value=""></td><td><input type="text" name="totalmod-door3" id="totalmod-door3" value=""></td></tr>
        <tr><td>unalocated</td><td><input type="text" name="total-unallocated" id="total-unallocated" value=""></td><td><input type="text" name="totalby5-unallocated" id="totalby5-unallocated" value=""></td><td><input type="text" name="totalmod-unallocated" id="totalmod-unallocated" value=""></td></tr>
        <tr><td>missing</td><td><input type="text" name="total-missing" id="total-missing" value=""></td></tr>
    </table>
    <input type="text" name="total-mod" id="total-mod" value="1.25">
</div>
<input class="easyui-textbox" label="First Name:" labelPosition="top" style="width:100%;height:52px">
<div id="table-controls">
    <div id="tabs-projects" class="tabs">
        <ul>
            <li><a id="show-projects" href="#tabs-3">show projects</a></li>
            <li><a id="hide-projects" href="#tabs-4">hide projects</a></li>
        </ul>
        <div id="tabs-3"></div>
        <div id="tabs-4"></div>
    </div>
    <div id="tabs-data" class="tabs">
        <ul>
            <li><a id="show-data" href="#tabs-1">show detail data</a></li>
            <li><a id="hide-data" href="#tabs-2">hide detail data</a></li>
        </ul>
        <div id="tabs-1"></div>
        <div id="tabs-2"></div>
    </div>
    <fieldset id="project-toggles">
        <legend>Hide data row for projects: </legend>
        <label for="checkbox-unalocated">UNALOCATED
            <input type="checkbox" name="checkbox-unalocated" id="checkbox-unalocated">
        </label>
        <label for="checkbox-wahv">WAHV
            <input type="checkbox" name="checkbox-wahv" id="checkbox-wahv">
        </label>
        <label for="checkbox-greenhill">Greenhill
            <input type="checkbox" name="checkbox-Greenhill" id="checkbox-greenhill">
        </label>
        <label for="checkbox-pch">PCH
            <input type="checkbox" name="checkbox-pch" id="checkbox-pch">
        </label>
        <label for="checkbox-pgpf">PGPF
            <input type="checkbox" name="checkbox-pgpf" id="checkbox-pgpf">
        </label>
        <label for="checkbox-resolution">Resolution
            <input type="checkbox" name="checkbox-resolution" id="checkbox-resolution">
        </label>
        <label for="checkbox-personal">Personal
            <input type="checkbox" name="checkbox-personal" id="checkbox-personal">
        </label>
        <label for="checkbox-door3">Door3
            <input type="checkbox" name="checkbox-door3" id="checkbox-door3">
        </label>
    </fieldset>
    <button id="hide-proj-all" class="ui-button ui-widget ui-corner-all">hide all projects</button>
</div>
<div id="restructured-data">
    <table id="restructured-data-table" border="1"></table>
</div>
<hr/>
<div id="project-form"><h1>Projects</h1>

    <div id="wahv">
        <h2>WAHV</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-wahv" id="keywords-wahv" rows="5" cols="50">
wahv
localhost:3000
brainwahve
jinwei
praveen
deepa
Elisei
jenkins
phppgadmin
postgres
knex
data:
pgsql
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-wahv" id="probablykeywords-wahv" rows="5" cols="50">
chimp
webdriver
cucumber
reports
node.js
react
mailinator
nodejs
npm
        </textarea>
    </div>    <br>

    <div id="greenhill">
        <h2>Greenhill</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-green" id="keywords-green" rows="5" cols="50">
greenhill
dunn
808705e3-d1e0-48d6-9e92-563ba1af548e
d8f01cef-3211-4d23-9c39-876ab642e0c0
gs-
amCharts
GS board
HEagar.d3.local
Greehill
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-green" id="probablykeywords-green" rows="5" cols="50">
green
        </textarea>
    </div>   <br>

    <div id="PCH">
        <h2>Peterson Healthcare</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-pch" id="keywords-pch" rows="5" cols="50">
pch
phc-
PHC board
2ee75d82-d073-496d-a030-f1b598662082
lance
teegarden
petersonhealthcare
Peterson Health
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-pch" id="probablykeywords-pch" rows="5" cols="50">
pch
        </textarea>
    </div>   <br>

    <div id="PGPF">
        <h2>Greenhill</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-pgpf" id="keywords-pgpf" rows="5" cols="50">
pgpf
6484fc6e-2a7a-4cef-b80a-a117593f3345
02dce34e-3e42-4d40-9055-0b82e3ab7849
curry
anila
</textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-pgpf" id="probablykeywords-pgpf" rows="5" cols="50">
ctsiokos
costa
tsiokos
        </textarea>
    </div>   <br>

    <div id="RESOLUTION">
        <h2>Resolution Project</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-res" id="keywords-res" rows="5" cols="50">
resolution
resolutionproject
linode
george
tsiatis
32542c10-f441-408f-ad12-556bb7d57dd4
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-res" id="probablykeywords-res" rows="5" cols="50">
resolution
        </textarea>
    </div>   <br>

    <div id="PERSONAL">
        <h2>Personal Project</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-personal" id="keywords-personal" rows="5" cols="50">
d5d70249-ef32-4a1d-b597-2950d79d4f32
haleagar.com
contests
minecraft
scratch
cube
doctor
Change.org
tdbank
barclaycardus
ynab
menshealth
ultimaker
formlabs
3dsystems
Sweepstakes
Restating the Obvious
Orlando
hawaii
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-personal" id="probablykeywords-personal" rows="5" cols="50">
vlc
youtube
facebook
Hal Eagar Theatrical Solutions
        </textarea>

        <h3><label>category Keywords</label></h3>
        <textarea title="categorykeywords-personal" id="categorykeywords-personal" rows="5" cols="50">
General Shopping
General News & Opinion
Kids Use
General Entertainment
Maps & Regional
youtube
facebook
3d print
wdw
        </textarea>
    </div>   <br>

    <div id="DOOR3">
        <h2>Door3</h2>
        <h3><label>Keywords</label></h3>
        <textarea title="keywords-door3" id="keywords-door3" rows="5" cols="50">
door3
pantheon
rescuetime
projectorpsa
        </textarea>
        <h3><label>Probably Keywords</label></h3>
        <textarea title="probablykeywords-door3" id="probablykeywords-door3" rows="5" cols="50">
jetbrains
phpstorm
pantheon
backtrac
jira
atlassian
github
sow
estimate
matrix
slack
stackoverflow
git
Commit
w3schools
css
jquery
react
angular
drupal
php
virtualbox
ubuntu
firefox
geaney
searchmonkey
localhost
Open Project
Open File
New File
JavaScript
Find in Path
Tip of the Day
        </textarea>
        <h3><label>category Keywords</label></h3>
        <textarea title="categorykeywords-door3" id="categorykeywords-door3" rows="5" cols="50">
General Software Development
        </textarea>
    </div>   <br>

</div><br>
<div id="loading-overlay"><div id="loading-text">loading ...</div></div>
</body>
</html>

